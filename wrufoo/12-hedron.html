<!doctype html>
<html lang="en">
<head>
    <title> 12-Hedron </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!--
    <link rel=stylesheet href="css/base.css"/>
-->
</head>
<body>

<script src="../build/Three.js"></script>

<script src="../examples/js/controls/OrbitControls.js"></script>
<script src="libs/DAT.GUI.min.js"></script>

<!-- ------------------------------------------------------------ -->


<div id="ThreeJS" style="z-index: 0; position: absolute; left:0px; top:0px"></div>  

<script>
/*
This is based on template.html which is derived from:
	Three.js "tutorials by example"
	Author: Lee Stemkoski
	Date: July 2013 (three.js v59dev)

Unneed code has been removed. Restore as needed.
*/

// MAIN

// standard global variables
var container, scene, camera, renderer, controls, stats;

// custom global variables
var mesh;

init();
animate();

// FUNCTIONS 		
function init() 
{
	// SCENE
	scene = new THREE.Scene();
	// CAMERA
	var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
	var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
	camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
	scene.add(camera);
	camera.position.set(0,150,400);
	camera.lookAt(scene.position);	
	// RENDERER
  renderer = new THREE.WebGLRenderer( {antialias:true} );
	renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
	container = document.getElementById( 'ThreeJS' );
	container.appendChild( renderer.domElement );
	// EVENTS
	// CONTROLS
	controls = new THREE.OrbitControls( camera, renderer.domElement );
	// STATS
	// LIGHT
	var light = new THREE.PointLight(0xffffff);
	light.position.set(100,250,100);
	scene.add(light);
  var amblight = new THREE.AmbientLight( 0x444444 );
  scene.add(amblight);
  
  var color1 = new THREE.Color( 0x777777 ) ;
  var color2 = new THREE.Color( 0xeeeeee ) ;
  scene.add( makeFloor( color1, color2, 1, 1 ));
  scene.add( new THREE.AxisHelper(100) );

	// SKYBOX
	var skyBoxGeometry = new THREE.CubeGeometry( 10000, 10000, 10000 );
	var skyBoxMaterial = new THREE.MeshBasicMaterial( { color: 0x9999ff, side: THREE.BackSide } );
	var skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );
	scene.add(skyBox);
	
	////////////
	//  GUI   //
	////////////

  var gui = new dat.GUI();
  gui_parameters =
  {
    floorcolor1:  "#777777",
    floorcolor2:  "#eeeeee",
    floorpnumber1: 1,
    floorpnumber2: 1,
    floorvisible: true,
    recolorfloor: function(){ paintfloor(); },
    model: "Flag"                  
  }

  var floorFolder = gui.addFolder( 'Floor' );

  var floorColor1 = floorFolder.addColor( gui_parameters, 'floorcolor1' )
          .name( "Color 1" );
  var floorColor2 = floorFolder.addColor( gui_parameters, 'floorcolor2' ) 
          .name( "Color 2" );
  floorFolder.add( gui_parameters, 'recolorfloor' ).name( "Paint Floor" );

  var floorNumber1 = floorFolder.add( gui_parameters, 'floorpnumber1' )
          .name( "Number 1" );
  var floorNumber2 = floorFolder.add( gui_parameters, 'floorpnumber2' )
          .name( "Number 2" );
  var floorVisible = floorFolder.add( gui_parameters, 'floorvisible' )
          .name( "Visible?" );

  var modelselector = gui.add( gui_parameters, 'model',
                [ "None", "FooBarb", "ButterFly", "Hexagon", "Pentagon", "Flag", "Icosahedron", "Sphere", "Cube" ] )
          .onChange( function(value) { changeModel( value ) } );



  function paintfloor()
  {
    color1x = parseInt( gui_parameters.floorcolor1.replace("#","0x") );
    var color1 = new THREE.Color( color1x );
    color2x = parseInt( gui_parameters.floorcolor2.replace("#","0x") );
    var color2 = new THREE.Color( color2x );
    var newfloor = makeFloor( color1, color2,
          gui_parameters.floorpnumber1, gui_parameters.floorpnumber2 ) ;
    newfloor.visible = gui_parameters.floorvisible;
    scene.remove( scene.getObjectByName( "FlOoR", false ) );
    scene.add( newfloor );
  }

  function changeModel( value ) 
  {
    scene.remove( scene.getObjectByName( "HeDrOn", false ) );
    if( value == "None" ){
        mesh = new THREE.Mesh( );
    } else if( value == "FooBarb" ) {
        mesh = fooBarbModel( 30 );
    } else if( value == "ButterFly" ) {
        mesh = butterFlyModel( 30 );
    } else if( value == "Pentagon" ) {
        mesh = ngonModel( 5, 30 );
    } else if( value == "Hexagon" ) {
        mesh = ngonModel( 6, 30 );
    } else if( value == "Flag" ){
        mesh = makeFoo();
    } else if( value == "Icosahedron" ){
        var geometry = new THREE.IcosahedronGeometry( 30, 0 );
        var material = new THREE.MeshLambertMaterial( { shading: THREE.FlatShading, wireframe:false, color: 0x999900 } );
        mesh = new THREE.Mesh( geometry, material );
        mesh.position.set(0,40,0);
    } else if( value == "Sphere" ){
        var geometry = new THREE.SphereGeometry( 30, 32, 16 );
        var material = new THREE.MeshLambertMaterial( { shading: THREE.FlatShading, wireframe:false, color: 0x999900 } );
        mesh = new THREE.Mesh( geometry, material );
        mesh.position.set(0,40,0);
    } else if( value == "Cube" ){
      mesh = Vertex_Colors();
    }
    scene.add( mesh );
    mesh.name = "HeDrOn";

  }

	////////////
	// CUSTOM //
	////////////
	
//  changeModel( "Pentagon" ); // FIXME -- temp for WIP
//  changeModel( "Hexagon" ); // FIXME -- temp for WIP
//  changeModel( "ButterFly" ); // FIXME -- temp for WIP
  changeModel( "FooBarb" ); // FIXME -- temp for WIP
}

function animate() 
{
  requestAnimationFrame( animate );
	render();		
	update();
}

function update()
{
	/*****************
  if ( keyboard.pressed("z") ) 
	{	  
		// do something
	}
	************************/
//////////////////////	controls.update();
	camera.up = new THREE.Vector3(0,1,0);
	//////////////////stats.update();
}

function render() 
{
	renderer.render( scene, camera );
}

function fooBarbModel( size )
{
  var redBallMesh = new THREE.Mesh(
        new THREE.SphereGeometry( 20 ),
        new THREE.MeshLambertMaterial( {color: 0xff0000} )
      );
  redBallMesh.position.x = 500;
  scene.add( redBallMesh );

  var greenBallMesh = new THREE.Mesh(
        new THREE.SphereGeometry( 20 ),
        new THREE.MeshLambertMaterial( {color: 0x00ff00} )
      );
  greenBallMesh.position.y = 500;
  scene.add( greenBallMesh );

  var blueBallMesh = new THREE.Mesh(
        new THREE.SphereGeometry( 20 ),
        new THREE.MeshLambertMaterial( {color: 0x0000ff} )
      );
  blueBallMesh.position.z = 500;
  scene.add( blueBallMesh );

  var mesh = new THREE.Mesh(
        new THREE.CylinderGeometry( 0, 20, 200 ),
        new THREE.MeshLambertMaterial( {color: 0xff0000} )
      );
  mesh.rotation.z = Math.PI / 4;
  mesh.position.x = 50;
  mesh.translateOnAxis( new THREE.Vector3(1,0,0), 50 );
  console.log(mesh.position);
  console.log( mesh.rotation );
  console.log( mesh.matrix );
  scene.add( mesh );
  return mesh;
}

function fooBarbModel0( size )
{
  var RPD  = Math.PI / 180;
  var boxGeometry = new THREE.BoxGeometry( size, 2 * size, 3 * size );
  var material = new THREE.MeshNormalMaterial( );
  var boxMesh = new THREE.Mesh( boxGeometry, material );
//  boxMesh.position.x = 50;
  boxMesh.rotation.x = 45 * RPD;
  boxMesh.rotation.y = 22 * RPD;
  scene.add( boxMesh );
  return boxMesh;
}

function butterFlyModel0( outRadius )
{
  inRadius = outRadius * Math.sin( 54 * Math.PI / 180 ) ;
  var y_axis = new THREE.Vector3(0,1,0);
  var z_axis = new THREE.Vector3(0,0,1);

  var obj0 = new THREE.Object3D();    
  var obj1 = new THREE.Object3D();    
  var obj2 = new THREE.Object3D();    
  var obj3 = new THREE.Object3D();    

  var geometry = new ngonGeometry( 5, outRadius );
  var material = new THREE.MeshLambertMaterial( { side: THREE.DoubleSide, shading: THREE.FlatShading, wireframe:false, color: 0x999900 } );
  var mesh = new THREE.Mesh( geometry, material );

  obj0.add( mesh );
  obj0.translateX( inRadius );
  
  obj1.add( obj0 );
  obj1.rotateOnAxis( y_axis, -148 * Math.PI / 180 );

  obj2.add( obj1.clone() );
  
  obj2.rotateOnAxis( z_axis, Math.PI );

  obj3.add( obj1 );
  obj3.add( obj2 );
  obj3.position.set(0,40,0);

  scene.add(obj3);
  return obj3;
}

function butterFlyModel( outRadius )
{
  var RPD  = Math.PI / 180;
  inRadius = outRadius * Math.sin( 54 * Math.PI / 180 ) ;
  dihedralAngle = 115 * RPD ;
  var y_axis = new THREE.Vector3(0,1,0);
  var z_axis = new THREE.Vector3(0,0,1);

  var geometry = new ngonGeometry( 5, outRadius );
  var material = new THREE.MeshNormalMaterial( { side: THREE.DoubleSide } );

  // Left side
  var mesh1 = new THREE.Mesh( geometry, material );
  mesh1.position.x = inRadius;
  mesh1.position.y = inRadius;  // raised
  var obj1 = new THREE.Object3D();    
  obj1.add( mesh1 );
  obj1.rotation.y = (3 * Math.PI - dihedralAngle) / 2; 
  
  // Right side`
  var mesh2 = new THREE.Mesh( geometry, material );
  mesh2.position.x = inRadius;
  mesh2.position.y = inRadius;  // raised
  mesh2.rotation.x = Math.PI;
  var obj2 = new THREE.Object3D();    
  obj2.add( mesh2 );
  obj2.rotation.y = -( Math.PI - dihedralAngle) / 2; 

  var obj3 = new THREE.Object3D();    
  obj3.add( obj1 );
  obj3.add( obj2 );
  
  scene.add( obj3 );
  return obj3;
/***********************
  var obj0 = new THREE.Object3D();    
  var obj1 = new THREE.Object3D();    
  var obj2 = new THREE.Object3D();    
  var obj3 = new THREE.Object3D();    


  obj0.add( mesh );
  obj0.translateX( inRadius );
  
  obj1.add( obj0 );
  obj1.rotateOnAxis( y_axis, -148 * Math.PI / 180 );

  obj2.add( obj1.clone() );
  
  obj2.rotateOnAxis( z_axis, Math.PI );

  obj3.add( obj1 );
  obj3.add( obj2 );
  obj3.position.set(0,40,0);

  scene.add(obj3);
  return obj3;
  *****************/
}


function ngonGeometry( n, radius )
{
  var geometry = new THREE.Geometry();
  geometry.vertices = ngonVertices( n, radius );
  var normal = new THREE.Vector3( 0, 0, 1 );
  for( var i = 1; i < n; i += 1 )
  {
    geometry.faces.push( new THREE.Face3( 0, i, i + 1, normal ) );
  }
  geometry.faces.push( new THREE.Face3( 0, n, 1, normal ) );
  geometry.computeBoundingSphere();
  return geometry ;
}

function ngonVertices( n, radius )
{
  var delta_theta = (2 * Math.PI ) / n;
  var vertices = [];
  for( var i = 0; i <= n; i += 1 )
  {
    var theta = i * delta_theta;
    var x = Math.cos( theta ) * radius
    var y = Math.sin( theta ) * radius
    vertices.push( new THREE.Vector3( x, y, 0 ) );
  }
  return vertices ;
}

function ngonModel( n, radius )
{
    var geometry = new ngonGeometry( n, radius );
    var material = new THREE.MeshLambertMaterial( { shading: THREE.FlatShading, wireframe:false, color: 0x999900 } );
    var mesh = new THREE.Mesh( geometry, material );
    mesh.position.set(0,40,0);
    scene.add(mesh);
    return mesh;
}        

function makeFloor( color1, color2, num1, num2 )
{
    var floorGeometry = new THREE.PlaneGeometry(1000, 1000, 10, 10);

    var i = 0;
    while( i + num1 + num2 <= floorGeometry.faces.length ){
      for( var j = 0; j < num1; j += 1 ){
        face  = floorGeometry.faces[ i ];	
        face.color.set(color1);		
        i += 1;
      }
      for( var j = 0; j < num2; j += 1 ){
        face  = floorGeometry.faces[ i ];	
        face.color.set(color2);		
        i += 1;
      }

    }

    var floorMaterial = new THREE.MeshBasicMaterial(
      { color: 0xffffff, vertexColors: THREE.FaceColors, side: THREE.DoubleSide } );
    var floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.position.y = -0.5;
    floor.rotation.x = Math.PI / 2;
    floor.name = "FlOoR";

    return floor;
}

function Vertex_Colors() 
{
	// this material causes a mesh to use colors assigned to faces
	var cubeMaterial = new THREE.MeshBasicMaterial( 
	{ color: 0xffffff, vertexColors: THREE.FaceColors } );
	
	var cubeGeometry = new THREE.CubeGeometry( 80, 80, 80, 3, 3, 3 );
	for ( var i = 0; i < cubeGeometry.faces.length; i++ ) 
	{
		face  = cubeGeometry.faces[ i ];	
		face.color.setRGB( Math.random(), Math.random(), Math.random() );		
	}
	cube = new THREE.Mesh( cubeGeometry, cubeMaterial );
	cube.position.set(-100, 50, 0);
	return cube;
}

function makeFoo()
{
  var geometry = new THREE.Geometry();

  geometry.vertices.push( new THREE.Vector3( 0, 100, 0) );
  geometry.vertices.push( new THREE.Vector3( 0, 0, 0) );
  geometry.vertices.push( new THREE.Vector3( 100, 0, 0) );
  geometry.vertices.push( new THREE.Vector3( 100, 100, 0) );

  geometry.faces.push( new THREE.Face3( 0, 1, 2 ) );
  geometry.faces.push( new THREE.Face3( 0, 2, 3 ) );
  geometry.faces[0].color.setHex(0xdd0000) ;
  geometry.faces[1].color.setHex(0x0000dd) ;

  var material = new THREE.MeshBasicMaterial(
      { vertexColors: THREE.FaceColors,
        wireframe: false,
        color: 0xffffff } );

  var mesh = new THREE.Mesh( geometry, material ) ;
  return mesh;
}


</script>

</body>
</html>
